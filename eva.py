import math
import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim
import torchvision
import torchvision.transforms as transforms
import argparse
import os
from torchvision import datasets
from einops import rearrange
from einops.layers.torch import Rearrange
import sys
from math import sqrt
from tqdm.auto import tqdm
import pandas as pd
import cv2
from PIL import Image
import csv

statlist = [['lemon'], ['betel', 'lemon'], ['bambooshoots', 'betel', 'cauliflower', 'custardapple', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pennisetum', 'sweetpotato', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['roseapple'], ['pear'], ['waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'cauliflower', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'roseapple', 'sesbania', 'sweetpotato', 'taro', 'tea', 'waterbamboo'], ['bambooshoots', 'broccoli', 'grape', 'longan', 'others', 'pear', 'pennisetum', 'sweetpotato', 'waterbamboo'], ['asparagus', 'custardapple', 'grape', 'greenonion', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['asparagus', 'broccoli', 'cauliflower', 'greenhouse', 'greenonion', 'kale', 'mango', 'others', 'papaya', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'loofah', 'mango', 'papaya'], ['bambooshoots', 'custardapple', 'greenonion', 'longan', 'loofah', 'papaya', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'loofah', 'others', 'papaya', 'sesbania', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['others'], ['asparagus', 'bambooshoots', 'chinesechives', 'greenhouse', 'lemon', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'taro'], ['bambooshoots', 'betel', 'custardapple', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'passionfruit', 'pennisetum', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'onion', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'custardapple', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'others', 'papaya', 'passionfruit', 'pear', 'sesbania', 'sweetpotato', 'taro'], ['sweetpotato'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'broccoli', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'others', 'papaya', 'pennisetum', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sweetpotato', 'taro'], ['broccoli', 'litchi', 'mango', 'others', 'papaya', 'sesbania', 'taro'], ['others'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenonion', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'lemon', 'lettuce', 'litchi', 'longan', 'mango', 'papaya', 'passionfruit'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['longan', 'papaya'], ['betel', 'others', 'papaya'], ['others'], ['bambooshoots', 'betel'], ['longan'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['chinesecabbage', 'taro'], ['broccoli', 'cauliflower', 'chinesecabbage', 'kale', 'longan', 'onion', 'others', 'pennisetum'], ['bambooshoots', 'custardapple', 'lemon', 'longan', 'mango', 'papaya'], ['bambooshoots', 'betel', 'cauliflower', 'chinesecabbage', 'greenhouse', 'greenonion', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'cauliflower', 'kale', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'sunhemp'], ['betel', 'grape', 'loofah', 'papaya', 'passionfruit', 'roseapple', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'greenhouse', 'greenonion', 'kale', 'lemon', 'longan', 'mango', 'onion', 'others', 'papaya', 'pennisetum', 'redbeans', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['pear'], ['asparagus', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'pennisetum', 'taro'], ['chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'mango', 'others', 'papaya', 'passionfruit', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lemon', 'longan', 'onion', 'others', 'papaya', 'pennisetum', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'custardapple', 'greenhouse', 'greenonion', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'onion', 'others', 'papaya', 'pennisetum', 'redbeans', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'chinesecabbage', 'chinesechives', 'grape', 'greenonion', 'kale', 'lemon', 'longan', 'loofah', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'longan', 'mango', 'pennisetum'], ['bambooshoots', 'broccoli', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'others', 'papaya', 'passionfruit', 'soybeans', 'sweetpotato', 'taro', 'tea', 'waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'custardapple', 'greenhouse', 'greenonion', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'sesbania', 'soybeans', 'taro'], ['longan'], ['bambooshoots', 'betel', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'sesbania', 'sweetpotato', 'taro'], ['bambooshoots', 'lemon', 'litchi', 'longan', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum'], ['custardapple', 'mango', 'passionfruit', 'redbeans'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'pear', 'pennisetum', 'roseapple', 'sweetpotato', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'betel', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['bambooshoots', 'broccoli', 'greenonion', 'kale', 'lemon', 'litchi', 'longan', 'mango', 'papaya', 'pennisetum', 'sweetpotato'], ['bambooshoots', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'sesbania', 'taro', 'waterbamboo'], ['greenonion'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro', 'tea', 'waterbamboo'], ['taro'], ['broccoli', 'kale', 'papaya', 'sunhemp', 'sweetpotato'], ['bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['papaya', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'chinesecabbage', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'sweetpotato', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pear', 'roseapple', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'chinesecabbage', 'custardapple', 'greenhouse', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato', 'taro'], ['bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'sweetpotato', 'taro', 'waterbamboo'], ['broccoli', 'chinesecabbage', 'greenonion', 'kale', 'lettuce', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'custardapple', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pear', 'roseapple', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'soybeans', 'sweetpotato', 'taro'], ['others'], ['kale', 'loofah', 'mango', 'others', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenhouse', 'greenonion', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['passionfruit'], ['bambooshoots', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'longan', 'papaya', 'passionfruit', 'sweetpotato', 'waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'chinesechives', 'custardapple', 'grape', 'kale', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['betel', 'mango', 'sesbania'], ['bambooshoots', 'betel', 'lemon', 'loofah', 'mango', 'papaya', 'redbeans', 'roseapple', 'sweetpotato', 'taro'], ['betel', 'custardapple', 'mango', 'pennisetum', 'taro'], ['bambooshoots', 'betel', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'longan', 'mango', 'others', 'papaya', 'pennisetum', 'sunhemp', 'sweetpotato'], ['asparagus', 'custardapple', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'taro'], ['custardapple'], ['bambooshoots', 'betel', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'greenhouse', 'longan', 'mango', 'sesbania', 'sunhemp', 'sweetpotato'], ['bambooshoots', 'betel', 'broccoli', 'chinesechives', 'custardapple', 'lemon', 'lettuce', 'litchi', 'longan', 'mango', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sunhemp', 'sweetpotato'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'custardapple', 'greenhouse', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato'], ['pear'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['mango'], ['betel', 'mango', 'others', 'papaya', 'soybeans'], ['bambooshoots', 'betel', 'broccoli', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'taro', 'tea'], ['mango'], ['betel', 'greenhouse', 'lemon', 'longan', 'loofah', 'mango', 'redbeans', 'roseapple', 'sesbania'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'chinesecabbage', 'greenonion', 'lemon', 'litchi', 'longan', 'mango', 'papaya', 'pear', 'sweetpotato'], ['bambooshoots', 'papaya', 'pennisetum', 'waterbamboo'], ['bambooshoots', 'betel', 'grape', 'greenonion', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'pennisetum', 'redbeans', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['custardapple'], ['betel', 'lemon', 'litchi', 'mango', 'papaya', 'sweetpotato'], ['asparagus', 'bambooshoots', 'betel', 'custardapple', 'grape', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'taro'], ['bambooshoots', 'betel', 'greenhouse', 'lemon', 'longan', 'mango', 'papaya', 'redbeans', 'roseapple', 'sesbania', 'soybeans'], ['bambooshoots', 'betel', 'papaya', 'pear', 'sweetpotato', 'taro', 'waterbamboo'], ['betel', 'longan', 'others', 'papaya', 'sesbania', 'tea'], ['betel', 'chinesecabbage', 'lemon', 'loofah', 'papaya', 'sesbania'], ['bambooshoots', 'betel', 'greenhouse', 'lemon', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'taro'], ['asparagus', 'bambooshoots', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'longan', 'loofah', 'papaya', 'sunhemp', 'sweetpotato'], ['mango'], ['longan', 'mango'], ['betel'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'sweetpotato'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'chinesecabbage', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'sesbania', 'sweetpotato', 'taro', 'tea', 'waterbamboo'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'roseapple', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'greenhouse', 'lettuce', 'longan', 'mango', 'papaya', 'passionfruit', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'grape', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'sesbania', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'betel', 'grape', 'greenonion', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sweetpotato', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'soybeans', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'litchi', 'longan', 'mango', 'papaya', 'roseapple'], ['bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['chinesecabbage', 'loofah'], ['broccoli', 'kale', 'mango', 'passionfruit', 'pennisetum', 'sweetpotato'], ['betel'], ['asparagus', 'bambooshoots', 'chinesecabbage', 'greenonion', 'litchi', 'longan', 'loofah', 'mango', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'greenonion', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'roseapple'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'chinesechives', 'custardapple', 'greenonion', 'kale', 'lemon', 'lettuce', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'sesbania', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'cauliflower', 'grape', 'greenonion', 'kale', 'mango', 'others', 'papaya', 'pennisetum', 'roseapple', 'sweetpotato', 'taro', 'waterbamboo'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['mango', 'pennisetum', 'sweetpotato'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sunhemp', 'sweetpotato', 'taro'], ['bambooshoots', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sweetpotato', 'waterbamboo'], ['bambooshoots', 'betel', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'roseapple', 'sweetpotato', 'taro', 'tea'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'custardapple', 'greenonion', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'litchi', 'longan', 'mango', 'others', 'papaya', 'pennisetum', 'roseapple', 'sweetpotato', 'taro'], ['cauliflower', 'chinesecabbage', 'greenonion', 'kale', 'lettuce', 'mango', 'others', 'sweetpotato', 'taro'], ['betel', 'pear'], ['chinesecabbage', 'lettuce', 'taro'], ['bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'broccoli', 'greenhouse', 'greenonion', 'pear'], ['bambooshoots', 'betel', 'custardapple', 'grape', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenhouse', 'greenonion', 'kale', 'lemon', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'roseapple', 'sesbania', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato', 'taro'], ['broccoli', 'chinesecabbage', 'greenonion', 'kale', 'lettuce', 'others', 'papaya', 'passionfruit', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'litchi', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'betel', 'longan', 'mango', 'others'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'sesbania', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'loofah', 'mango', 'others', 'papaya', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pear', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato', 'taro'], ['mango'], ['bambooshoots', 'sesbania'], ['greenhouse', 'loofah'], ['asparagus', 'bambooshoots', 'betel', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['betel', 'lemon', 'mango', 'papaya'], ['bambooshoots', 'betel', 'mango', 'taro'], ['greenonion', 'sunhemp', 'sweetpotato'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'roseapple', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['betel'], ['bambooshoots', 'betel', 'litchi', 'loofah', 'mango', 'papaya', 'pennisetum', 'sweetpotato', 'tea'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'sweetpotato', 'taro'], ['asparagus', 'broccoli', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenonion', 'kale', 'lettuce', 'longan', 'loofah', 'onion', 'others', 'papaya', 'pennisetum', 'redbeans', 'sesbania', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['bambooshoots', 'betel', 'custardapple', 'greenonion', 'mango', 'others', 'papaya', 'pennisetum', 'sweetpotato', 'taro'], ['others'], ['others', 'sesbania'], ['pear'], ['bambooshoots', 'betel', 'broccoli', 'custardapple', 'greenhouse', 'greenonion', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pennisetum', 'redbeans', 'roseapple', 'sesbania', 'soybeans', 'taro'], ['bambooshoots', 'chinesechives', 'kale', 'mango', 'papaya', 'pear', 'sweetpotato', 'taro'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lemon', 'lettuce', 'longan', 'mango', 'onion', 'others', 'papaya', 'pennisetum', 'redbeans', 'soybeans', 'sunhemp', 'sweetpotato', 'taro'], ['chinesecabbage', 'kale', 'litchi', 'loofah', 'papaya', 'sweetpotato', 'waterbamboo'], ['bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'pear', 'sweetpotato', 'taro'], ['papaya'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'custardapple', 'grape', 'greenhouse', 'greenonion', 'kale', 'lemon', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'papaya', 'passionfruit', 'pear', 'pennisetum', 'roseapple', 'sesbania', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots', 'longan', 'mango'], ['asparagus', 'bambooshoots', 'cauliflower', 'chinesecabbage', 'custardapple', 'greenhouse', 'kale', 'lemon', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'pennisetum', 'sesbania', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo'], ['bambooshoots'], ['betel'], ['bambooshoots', 'mango', 'others', 'pennisetum'], ['asparagus', 'bambooshoots', 'betel', 'litchi', 'longan'], ['asparagus', 'bambooshoots', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'greenonion', 'kale', 'lettuce', 'litchi', 'longan', 'loofah', 'mango', 'others', 'papaya', 'passionfruit', 'soybeans', 'sweetpotato', 'taro', 'waterbamboo'], ['betel', 'taro'], ['betel', 'lemon', 'mango', 'papaya', 'taro'], ['asparagus', 'bambooshoots', 'betel', 'broccoli', 'cauliflower', 'chinesecabbage', 'chinesechives', 'grape', 'greenhouse', 'greenonion', 'kale', 'lettuce', 'loofah', 'mango', 'onion', 'others', 'papaya', 'passionfruit', 'pennisetum', 'soybeans', 'sunhemp', 'sweetpotato', 'taro', 'waterbamboo']]
townlist = ['七股區', '九如鄉', '二水鄉', '二林鎮', '二崙鄉', '八德區', '三地門鄉', '三星鄉', '三峽區', '三義鄉', '三灣鄉', '下營區', '口湖鄉', '土庫鎮', '大內區', '大甲區', '大安區', '大村鄉', '大肚區', '大里區', '大林鎮', '大武鄉', '大城鄉', '大埤鄉', '大湖鄉', '大雅區', '大園區', '大溪區', '大寮區', '大樹區', '山上區', '中山區', '中埔鄉', '中寮鄉', '中壢區', '元長鄉', '內門區', '內埔鄉', '內湖區', '公館鄉', '六甲區', '六腳鄉', '太平區', '太保市', '太麻里鄉', '斗六市', '斗南鎮', '水上鄉', '水里鄉', '水林鄉', '冬山鄉', '北斗鎮', '北區', '北港鎮', '古坑鄉', '四湖鄉', '外埔區', '左鎮區', '平鎮區', '民雄鄉', '永康區', '永靖鄉', '玉井區', '玉里鎮', '田中鎮', '田尾鄉', '田寮區', '白河區', '光復鄉', '吉安鄉', '名間鄉', '后里區', '安定區', '朴子市', '池上鄉', '竹山鎮', '竹北市', '竹田鄉', '竹東鎮', '竹南鎮', '竹崎鄉', '竹塘鄉', '西屯區', '西區', '西螺鎮', '伸港鄉', '沙鹿區', '秀水鄉', '秀林鄉', '芎林鄉', '里港鄉', '佳冬鄉', '來義鄉', '卑南鄉', '卓蘭鎮', '和美鎮', '官田區', '岡山區', '延平鄉', '東山區', '東石鄉', '東河鄉', '東區', '東港鎮', '東勢區', '東勢鄉', '枋山鄉', '枋寮鄉', '林內鄉', '林園區', '林邊鄉', '社頭鄉', '芬園鄉', '花蓮市', '花壇鄉', '芳苑鄉', '虎尾鎮', '金峰鄉', '長治鄉', '南化區', '南州鄉', '南庄鄉', '南投市', '屏東市', '後壁區', '後龍鎮', '春日鄉', '柳營區', '美濃區', '苑裡鎮', '香山區', '員林市', '埔心鄉', '埔里鎮', '埔鹽鄉', '崁頂鄉', '桃園區', '烏日區', '草屯鎮', '高樹鄉', '國姓鄉', '埤頭鄉', '崙背鄉', '梅山鄉', '梧棲區', '清水區', '通霄鎮', '造橋鄉', '魚池鄉', '鳥松區', '鹿谷鄉', '鹿草鄉', '鹿野鄉', '鹿港鎮', '麥寮鄉', '麻豆區', '善化區', '湖口鄉', '番路鄉', '莿桐鄉', '集集鎮', '新化區', '新市區', '新社區', '新城鄉', '新屋區', '新埔鎮', '新埤鄉', '新港鄉', '新園鄉', '新豐鄉', '楊梅區', '楠西區', '溪口鄉', '溪州鄉', '溪湖鎮', '獅子鄉', '瑞穗鄉', '義竹鄉', '萬丹鄉', '萬巒鄉', '達仁鄉', '壽豐鄉', '彰化市', '旗山區', '滿州鄉', '福興鄉', '臺西鄉', '臺東市', '銅鑼鄉', '鳳林鎮', '潭子區', '潮州鎮', '線西鄉', '褒忠鄉', '橫山鄉', '頭份市', '頭屋鄉', '龍井區', '龍崎區', '歸仁區', '關山鎮', '關西鎮', '關廟區', '霧峰區', '蘆竹區', '麟洛鄉', '鹽埔鄉', '觀音區']
label = {'asparagus': 0, 'bambooshoots': 1, 'betel': 2, 'broccoli': 3, 'cauliflower': 4, 'chinesecabbage': 5, 'chinesechives': 6, 'custardapple': 7, 'grape': 8, 'greenhouse': 9, 'greenonion': 10, 'kale': 11, 'lemon': 12, 'lettuce': 13, 'litchi': 14, 'longan': 15, 'loofah': 16, 'mango': 17, 'onion': 18, 'others': 19, 'papaya': 20, 'passionfruit': 21, 'pear': 22, 'pennisetum': 23, 'redbeans': 24, 'roseapple': 25, 'sesbania': 26, 'soybeans': 27, 'sunhemp': 28, 'sweetpotato': 29, 'taro': 30, 'tea': 31, 'waterbamboo': 32}


read_csv = pd.read_csv("C:/Users/wayne/Desktop/town/moreinfo_image.csv")
all_file_name = read_csv["Img"]
location = read_csv["TOWNNAME"]

model = torch.jit.load('./model4.pth')
model.eval() # 進入評估狀態
device = torch.device("cuda")
model = model.to(device)

transform_test = transforms.Compose([
    transforms.Resize((224,224)),
    transforms.ToTensor(),
    transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),
])

torch.no_grad()

predict = []

def test_csv():
    for i in range(500):
        print(i)
        img = Image.open("C:/pre/asparagus/" + all_file_name[i])
        image = transform_test(img).unsqueeze(0)
        img_ = image.to(device)
        outputs = model(img_)
        outputlist = outputs.tolist()[0]
        prob = math.inf*-1
        predicte_num = 0
        try:
            index = townlist.index(location[i])
        except Exception as e:
            index = -1
        if(index!=-1):
            for item in statlist[index]:
                if(outputlist[label[item]]>prob):
                    prob = outputlist[label[item]]
                    predicte_num = label[item]
        else: predicte_num = outputlist.index(max(outputlist))
        predict.append(predicte_num)


test_csv()

with open('venv/output.csv', 'w', newline='') as csvfile:
  # 建立 CSV 檔寫入器
  writer = csv.writer(csvfile)
  # 寫入一列資料
  writer.writerow(['filename', 'label'])
  for i in range(500):
      writer.writerow([all_file_name[i], predict[i]])